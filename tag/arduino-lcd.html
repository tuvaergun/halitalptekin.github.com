<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Halit Alptekin Personal Blog</title>
    <meta name="description" content="Programming and Life Blog Of Halit Alptekin. Karadeniz Technical University Computer Engineering Student.">
    <meta name="keywords" content="programlama, blog, personal blog, linux, python, django, php, bootstrap, seo, bilgisayar muhendisligi, ktu, karadeniz teknik universitesi, programming">
    <meta name="author" content="halit">
    <meta name="robots" content="index, follow, all"/>

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="../theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="../theme/bootstrap.min.css" rel="stylesheet">
    <link href="../theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="../theme/local.css" rel="stylesheet">
    <link href="../theme/pygments.css" rel="stylesheet">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="..">Halit Alptekin Personal Blog</a>

        <div class="nav-collapse">
        <ul class="nav">
                    
        <li><a href="../pages/about-me.html">About Me</a></li>
	    <li><a href="../pages/contact.html">Contact</a></li>
        </ul>
        </div>
        
    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
                
        

    <div class='article'>
        <div class="content-title">
            <a href="../python-ve-arduino-haberlesmesi.html"><h1>Python Ve Arduino Haberleşmesi</h1></a>
            Jun 30, 2012

by <a class="url fn" href="../author/halit.html">halit</a>
 

in <a href="../category/arduino.html">arduino</a>

 
    tagged <a href="../tag/arduino-lcd.html">arduino lcd</a> <a href="../tag/arduino-python.html">arduino python</a> <a href="../tag/python.html">python</a> <a href="../tag/python-ve-arduino.html">python ve arduino</a> <a href="../tag/seri-haberlesme.html">seri haberleşme</a> <a href="../tag/seri-port.html">seri port</a>  
        </div>
        
        <div><p>Son birkaç gundur kendimi tamamen Arduino'ya atadım.Elimde olan tum elektronik devre elemanlarını Arduino ile kullanmaya çalışıyorum.Bunlar cd-romdan çıkan lazerden tutunda,uzak kumanda devreleri,dc motorlar vb olabiliyor.Bunların yanında surekli aklımda olan birşey de Arduino ile internet kullanımı idi.Bunun yapılması için birçok yerde ethernet shield satıldığını gordum.Ben yeniden para harcamak yerine sadece ufak bir beyin fırtınası yaptım ve Arduino ile pc seri haberleşiyorsa bu haberleşme sırasında Pythonuda devreye sokarak internete erişebilirim dedim.Bunun hakkında yaptığım araştırmada benim gibi duşunen insanları gordum ve kodları inceledim.Sonuç olarak RSS kaynaklarından verileri çekip bunları seri porttan Arduino'ya gonderdim ve onunda bu verileri LCD'ye basmasını sağladım.Şimdilik masamda son haberleri gosteren bir LCD'nin olması beni çok mutlu etti.</p>
<p>Eğer sizde Arduino'nuz ile internete erişmek istiyorsanız oncelikle <strong>Seri Haberleşme</strong> ve <strong>LCD Kullanımı</strong> kavramlarını iyice oğrenmeniz gerekli.Zaten bunlar gayet basit konular.Bir goruşte oğrenebilirsiniz.Şimdi ben bu konuları oğrendiğinizi varsayıyorum ve kuruluma geçiyorum.</p>
<p>Öncelikle olayın mantığını iyice anlayalım.Python'un içindeki RSS parser ile RSS kaynağından verileri çekiyoruz.Ve bu verileri LCD'de gozukurken sorun çıkmaması için Turkçe karakterlerden arındırıyoruz.Daha sonra bu verileri seri haberleşme portundan Arduino'ya gonderiyoruz.Bu kısım olayın Python bolgesi.Burada kullandığım kod aşağıdaki gibi.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="codehilite"><pre><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf8 -*-</span>

<span class="kn">import</span> <span class="nn">serial</span>
<span class="kn">import</span> <span class="nn">feedparser</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">unidecode</span>

<span class="k">def</span> <span class="nf">donustur</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>   
    <span class="n">rep</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;İ&#39;</span><span class="p">,</span><span class="s">&#39;I&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;Ğ&#39;</span><span class="p">,</span><span class="s">&#39;G&#39;</span><span class="p">),(</span><span class="s">&#39;Ü&#39;</span><span class="p">,</span><span class="s">&#39;U&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;Ş&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;Ö&#39;</span><span class="p">,</span><span class="s">&#39;O&#39;</span><span class="p">),(</span><span class="s">&#39;Ç&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">),(</span><span class="s">&#39;ı&#39;</span><span class="p">,</span><span class="s">&#39;i&#39;</span><span class="p">),(</span><span class="s">&#39;ğ&#39;</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">),(</span><span class="s">&#39;u&#39;</span><span class="p">,</span><span class="s">&#39;u&#39;</span><span class="p">),(</span><span class="s">&#39;ş&#39;</span><span class="p">,</span><span class="s">&#39;s&#39;</span><span class="p">),(</span><span class="s">&#39;o&#39;</span><span class="p">,</span><span class="s">&#39;o&#39;</span><span class="p">),(</span><span class="s">&#39;ç&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">),(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39; &#39;</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">search</span><span class="p">,</span> <span class="n">replace</span> <span class="ow">in</span> <span class="n">rep</span><span class="p">:</span>
            <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">search</span><span class="p">,</span> <span class="n">replace</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span>

<span class="n">serialport</span>       <span class="o">=</span>  <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s">&#39;/dev/ttyACM0&#39;</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>
<span class="n">hltalptkn</span>        <span class="o">=</span>  <span class="n">feedparser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&quot;http://www.halitalptekin.com/rss&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">hltalptkn</span><span class="o">.</span><span class="n">entries</span><span class="p">:</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">donustur</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">))</span>
                <span class="n">serialport</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
                <span class="k">print</span> <span class="n">title</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

            <span class="n">serialport</span><span class="o">.</span><span class="n">flushOutput</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Yukarıdaki kodda değiştirmeniz gereken 2 yer var.Bunlardan ilki  hltalptkn değişkenindeki RSS adresi ve onun hemen ustundeki serialport değişkenindeki serial port adresi.Bu ikisini kendinize gore ayarladıktan sonra kodu çalıştırabiliriz.Zaten kod sonsuz dongude olduğu için surekli olarak yazıları çekip size gosterecektir.</p>
<p>Şimdi gelelim işin Arduino kısmına.LCD'mizi aşağıdaki gibi bağladığınızı duşunuyorum.(Her LCD'nin bağlanma şekli datasheetlerinde gosterilir.Bunu dikkate alınız)</p>
<p><img alt="Arduino LCD" src="http://www.halitalptekin.com/media/upload/arduino-lcd.png" /></p>
<p>Potansiyometremiz ile uygun kontrast değerini buluyoruz.Bundan sonra aşağıdaki kodumuzu Arduino'ya gonderiyoruz ve programlıyoruz.</p>
<div class="codehilite"><pre><span class="cp">#include liquidcrystal.h</span>

<span class="n">String</span> <span class="n">mesaj</span>  <span class="o">=</span>  <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="n">LiquidCrystal</span> <span class="nf">lcd</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
  <span class="n">lcd</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="p">}</span>
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">while</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
  <span class="p">}</span>
  <span class="n">lcd</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
    <span class="k">while</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">){</span>
      <span class="n">mesaj</span>  <span class="o">+=</span>  <span class="kt">char</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
      <span class="n">delay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">mesaj</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">lcd</span><span class="p">.</span><span class="n">setCursor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">lcd</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">mesaj</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">));</span>
  <span class="n">lcd</span><span class="p">.</span><span class="n">setCursor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">lcd</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">mesaj</span><span class="p">.</span><span class="n">substring</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>

  <span class="n">mesaj</span>  <span class="o">=</span>  <span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>


<p>Yukarıdaki kodun mantığıda belli.Seri porttan gelen verileri kontrol ediyor.Eğer veri varsa bunların ilk 16sını uste diğer kısmını alta yazıyor.daha fazla ise şimdilik gostermiyor.Bir ilerki versiyonda kayarak gostericem.Bu haliyle işinizi gorur ama.Zaten amaç Arduino'yu internete Ethernet Shield olmadan bağlamak.</p>
<p>Eğer başarı ile yaptıysanız LCD'de aşağıdaki gibi bir goruntu goreceksiniz.</p>
<p><img alt="Arduino ve Python 1" src="http://www.halitalptekin.com/media/upload/2012-06-30_23.31.52.jpg" /></p>
<p>RSS kaynağından yazılar 10 saniyede bir çekilecek ve ekrana basılacak.</p>
<p><img alt="Python ve Arduino" src="http://www.halitalptekin.com/media/upload/2012-06-30_23.32.10.jpg" /></p>
<p>Uygun kontrast değerini potansiyometre ile ayarlayacağınızı unutmayın.</p>
<p><img alt="Python ve Arduino 3" src="http://www.halitalptekin.com/media/upload/2012-06-30_23.33.00.jpg" /></p>
<p>LCD'nin pinlerini lehimlemek için az uğraşmadım ha :D</p>
<p><img alt="Python ve Arduino" src="http://www.halitalptekin.com/media/upload/2012-06-30_23.33.08.jpg" /></p>
<p>Hangi yazıların ekrana basılacağını çalıştırdığınız python dosyasında ve serial monitorde gorebilirsiniz.Farklı uygulamalarda kullanmanız dileğiyle.</p></div>
        <hr />
    </div>
		
            <div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="../tag/arduino-lcd.html">1</a></li>

    <li class="next disabled"><a href="#">&rarr; Next</a></li>

</ul>
</div>    
 
  
        </div>
        
        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Site
                </li>
            
                <li><a href="../archives.html">Archives</a>
                <li><a href="../tags.html">Tags</a>
                <li><a href="../feeds/all.atom.xml" rel="alternate">Atom feed</a></li>
                                <li><a href="../feeds/all.rss.xml" rel="alternate">RSS feed</a></li>
                                 <li><a href="../sitemap.xml">Sitemap</a>
            </ul>
            </div>


                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Categories
                </li>
                
                                <li><a href="../category/tasarim.html">tasarim</a></li>
                                <li><a href="../category/server.html">server</a></li>
                                <li><a href="../category/python.html">python</a></li>
                                <li><a href="../category/programlama.html">programlama</a></li>
                                <li><a href="../category/linux.html">linux</a></li>
                                <li><a href="../category/kisisel.html">kisisel</a></li>
                                <li><a href="../category/internet.html">internet</a></li>
                                <li><a href="../category/guvenlik.html">guvenlik</a></li>
                                <li><a href="../category/genel.html">genel</a></li>
                                <li><a href="../category/eglence.html">eglence</a></li>
                                <li><a href="../category/django.html">django</a></li>
                                <li><a href="../category/compsci.html">compsci</a></li>
                                <li><a href="../category/arduino.html">arduino</a></li>
                                   
            </ul>
            </div>
            

                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Links
                </li>
            
                            <li><a href="http://www.python.org">Python</a></li>
                        </ul>
            </div>
            

                        <div class="social">
            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Social
                </li>
           
                                <li><a href="http://twitter.com/halitalptekin">twitter</a></li>
                                <li><a href="http://github.com/halitalptekin">github</a></li>
                                <li><a href="http://stackoverflow.com/users/1151618/halit-alptekin">stackoverflow</a></li>
                                <li><a href="http://tr.linkedin.com/in/halitalptekin">linkedin</a></li>
                            </ul>
            </div>
            </div>
            
                        <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header"> 
                Ads
                </li>

                                <li><a href="https://www.camekan.com/adwords/" title="Google Adwords"><img src="/media/reklam/camekancom.jpg" alt="Google Adwords" title="Google Adwords"></a>
                </li>
                                <li><a href="http://www.dugunajans.com/" title="düğün fotoğrafçısı"><img src="/media/reklam/dugunajanscom.jpg" alt="düğün fotoğrafçısı" title="düğün fotoğrafçısı"></a>
                </li>
                            </ul>
            </div>
            
        </div>  
    </div>     </div> 
<footer>
	<hr>
	<p><a href='http://www.halitalptekin.com'>Halit Alptekin Personal Blog</a> &copy; 2012</p>
</footer>

</div> <!-- /container -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
<script>var _gaq=[['_setAccount','UA-24728900-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
</body>
</html>